
<!DOCTYPE doctype html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="ie=edge" http-equiv="x-ua-compatible"/>
<meta content="Baltica - Integrated differential junction usage (DJU)" name="description"/>
<link href="https://github.com/dieterich-lab/Baltica/benchmark.html" rel="canonical"/>
<meta content="Thiago Britto-Borges" name="author"/>
<meta content="Copy to clipboard" name="lang:clipboard.copy"/>
<meta content="Copied to clipboard" name="lang:clipboard.copied"/>
<meta content="en" name="lang:search.language"/>
<meta content="True" name="lang:search.pipeline.stopwords"/>
<meta content="True" name="lang:search.pipeline.trimmer"/>
<meta content="No matching documents" name="lang:search.result.none"/>
<meta content="1 matching document" name="lang:search.result.one"/>
<meta content="# matching documents" name="lang:search.result.other"/>
<meta content="[\s\-]+" name="lang:search.tokenizer"/>
<link href="assets/images/favicon.png" rel="shortcut icon"/>
<meta content="mkdocs-1.0.4, mkdocs-material-4.6.3" name="generator"/>
<title>5 - Benchmark with artificial transcripts - Baltica Documentation</title>
<link href="assets/stylesheets/application.adb8469c.css" rel="stylesheet"/>
<link href="assets/stylesheets/application-palette.a8b3c06d.css" rel="stylesheet"/>
<meta content="#757575" name="theme-color"/>
<script src="assets/javascripts/modernizr.86422ebf.js"></script>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
<link href="assets/fonts/material-icons.css" rel="stylesheet"/>
<link href="extra.css" rel="stylesheet"/>
</head>
<body data-md-color-accent="blue-grey" data-md-color-primary="grey" dir="ltr">
<svg class="md-svg">
<defs>
<svg height="448" id="__github" viewbox="0 0 416 448" width="416" xmlns="http://www.w3.org/2000/svg"><path d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z" fill="currentColor"></path></svg>
</defs>
</svg>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<a class="md-skip" href="#rna-seq-processing-and-mapping" tabindex="0">
        Skip to content
      </a>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a aria-label="Baltica Documentation" class="md-header-nav__button md-logo" href="https://github.com/dieterich-lab/Baltica" title="Baltica Documentation">
<i class="md-icon"></i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
              Baltica Documentation
            </span>
<span class="md-header-nav__topic">
              
                5 - Benchmark with artificial transcripts
              
            </span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-icon md-search__icon" for="__search"></label>
<button class="md-icon md-search__icon" data-md-component="reset" tabindex="-1" type="reset">
        
      </button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
            Type to start searching
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a class="md-source" data-md-source="github" href="https://github.com/dieterich-lab/Baltica/" title="Go to repository">
<div class="md-source__icon">
<svg height="24" viewbox="0 0 24 24" width="24">
<use height="24" width="24" xlink:href="#__github"></use>
</svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container">
<main class="md-main" role="main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title md-nav__title--site" for="__drawer">
<a class="md-nav__button md-logo" href="https://github.com/dieterich-lab/Baltica" title="Baltica Documentation">
<i class="md-icon"></i>
</a>
    Baltica Documentation
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-source="github" href="https://github.com/dieterich-lab/Baltica/" title="Go to repository">
<div class="md-source__icon">
<svg height="24" viewbox="0 0 24 24" width="24">
<use height="24" width="24" xlink:href="#__github"></use>
</svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="index.html" title="1 - Index">
      1 - Index
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="intro.html" title="2 - Introduction">
      2 - Introduction
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="setup.html" title="3 - Getting started">
      3 - Getting started
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="workflows.html" title="4 - Methods">
      4 - Methods
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-toggle md-nav__toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        5 - Benchmark with artificial transcripts
      </label>
<a class="md-nav__link md-nav__link--active" href="benchmark.html" title="5 - Benchmark with artificial transcripts">
      5 - Benchmark with artificial transcripts
    </a>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#rna-seq-processing-and-mapping">
    RNA-Seq processing and mapping
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dju-method-produces-results-with-little-agreement">
    DJU method produces results with little agreement
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#benchmark">
    Benchmark
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#results-from-the-methods-benchmark">
    Results from the methods benchmark
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="integration.html" title="6 - DJU methods result integration">
      6 - DJU methods result integration
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="release-notes.html" title="Release notes">
      Release notes
    </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#rna-seq-processing-and-mapping">
    RNA-Seq processing and mapping
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dju-method-produces-results-with-little-agreement">
    DJU method produces results with little agreement
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#benchmark">
    Benchmark
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#results-from-the-methods-benchmark">
    Results from the methods benchmark
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset"><a class="md-content__icon pdf-download-btn" download href="pdf/baltica_docs.pdf" title="Download"><i class="fa fas fa-download"></i><small> PDF</small></a>
<a class="md-icon md-content__icon" href="https://github.com/dieterich-lab/Baltica/tree/master/docs/benchmark.md" title="Edit this page"></a>
<h1>5 - Benchmark with artificial transcripts</h1>
<p>We implemented a benchmark method for DJU methods using the Spike-In RNA Variants (SIRVs Set-1, cat 025.03<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">1</a></sup>) as ground-truth for alternative splicing identification.
Differential splicing methods often use simulated data for benchmark, which does not fully appreciate the complexity of RNA-Sequencing experiment. We use a complementary approach that aims to overcome this limitation. The SIRVs spike-in comprise seven genes, 69 transcript isoforms, 357 exons and 113 intron
According to our experimental design (<strong>Fig. 5.1</strong>), differences in transcript abundance lead to differential splicing events in SIRV chromosomes but not in the human contigs, which would represent false-positive calls. </p>
<p>To benchmark the dataset, we use Baltica to run the three tools comparing three groups:<br/>
- mix 2 versus mix 1<br/>
- mix 3 versus mix 2<br/>
- mix 3 versus mix 1  </p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The test data currently shipping with Baltica has only a subset of 10% of the reads per group in Gerbracht et al. 2020 (<a href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-8461/">E-MTAB-8461</a>).</p>
</div>
<p><img alt="" class="center" src="img/experiment_design.png"/> <strong>Fig. 5.1: Experimental design</strong>: The first column represents the experimental groups. See <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">2</a></sup> for detail on the biological differences among groups. The second column represents the SIRV mixes. The third column is the sample id from the sequencing facility. </p>
<h2 id="rna-seq-processing-and-mapping">RNA-Seq processing and mapping<a class="headerlink" href="#rna-seq-processing-and-mapping" title="Permanent link">¶</a></h2>
<p>Cell lines, RNA extraction, and RNA-Seq were described by <sup id="fnref2:1"><a class="footnote-ref" href="#fn:1">2</a></sup>. In short, we obtained 15 libraries from Flp-In T-REx 293 cells, extracted the RNA fraction, with TrueSeq Stranded Total RNA kit (Illumina), followed by ribosomal RNA depletion, with RiboGold Plus kit. Reads were sequenced with an Illumina HiSeq4000 sequencer using PE 100bp protocol and yield around 50 million reads per sample. Data is deposited in ArrayExpress (E-MTAB-8461).
Sequenced reads' adapters and low-quality bases were trimmed, and reads mapping to human precursor ribosomal RNA were discarded.
The remaining reads were aligned to the human transcriptome (version 38, EnsEMBL 90) extended with the SIRV annotation.
Regarding the DJU method benchmarking, we are not interested in the biological condition, but the SIRVs AS event, and so this experiment was designed, so the SIRVs mixes were not confounded to the biological factors.</p>
<h2 id="dju-method-produces-results-with-little-agreement">DJU method produces results with little agreement<a class="headerlink" href="#dju-method-produces-results-with-little-agreement" title="Permanent link">¶</a></h2>
<p>To demonstrated the previously observed lack of consensus among DJU methods, we computed DJU with JunctionSeq, Majiq, and Leafcutter with the SIRVs, for three mixes containing a variable abundance of each transcript. The difference abundances are equivalent to differences in junction usage. The mixes were incorporated into the RNA-Seq experiment in non-confounded design with the biological co-variates, so the SJ observed in the natural contigs (human chromosome) could be used as false-positive calls. <strong>Table 5.1</strong> shows the number of SJ identified and called significant ( see the <a href="integration.html">Workflow Chapter</a> for detains on how the we reconcile these results). Majiq and JunctionSeq call around 310 significant SJ, while Leafcutter calls 201. Overall, the methods produce a comparable number of SJ called significant.</p>
<table>
<thead>
<tr>
<th>-</th>
<th align="right">Junctionseq</th>
<th align="right">Majiq</th>
<th align="right">Leafcutter</th>
</tr>
</thead>
<tbody>
<tr>
<td>Total</td>
<td align="right">608</td>
<td align="right">2850</td>
<td align="right">131676</td>
</tr>
<tr>
<td>Significant</td>
<td align="right">311</td>
<td align="right">309</td>
<td align="right">201</td>
</tr>
</tbody>
</table>
<p><strong>Table 5.1</strong>: Number of SJ considered (Total) and called significant (Significant) for each method.</p>
<p>However, when comparing the resulting gene and SJ sets, we observe a limited intersection among the results from the three methods (<strong>Fig. 5.2</strong>) for genes and SJ. To further understand this issue, we reviewed the step-by-step process implemented by the methods. Overall, the three DJU methods share three steps, as mentioned before:  </p>
<ul>
<li>Reads are extracted and filtered from the read alignments.</li>
<li>Testable SJ or splicing events are identified, for example, by clustering.</li>
<li>The SJ or splicing events counts are modelled.</li>
</ul>
<p><img alt="" src="img/results_with_little_aggrement.png"/></p>
<p><strong> Fig. 5.2: Overlap between genes and SJ called significant by three DJU methods.</strong> JunctionSeq, Majiq and, Leafcutter deliver results that show a limited agreement among each other. We computed differential junction usage using the three methods on 15 RNA-Seq libraries with 3 groups, the three SIRV mixes. The resulting intersection shows that only small overlap genes (<strong>A</strong>) and SJ (<strong>B</strong>) called significant by the tools 9% (6 out of 66) and 16% (34 out of 212), respectively.</p>
<h2 id="benchmark">Benchmark<a class="headerlink" href="#benchmark" title="Permanent link">¶</a></h2>
<p>We extracted all introns from the SIRV transcripts and classified between diff (changing between mixes) and no diff. Given the binary outcome from each tool, we analysed the following cases:</p>
<ul>
<li>True positive: diff intron called significant </li>
<li>False-positive: no diff intron or intron in human contig called significant  </li>
<li>True negative: no diff not called significant  </li>
<li>False-negative: diff intron not called significant  </li>
</ul>
<h2 id="results-from-the-methods-benchmark">Results from the methods benchmark<a class="headerlink" href="#results-from-the-methods-benchmark" title="Permanent link">¶</a></h2>
<table>
<thead>
<tr>
<th></th>
<th align="right">TN</th>
<th align="right">FP</th>
<th align="right">FN</th>
<th align="right">TP</th>
</tr>
</thead>
<tbody>
<tr>
<td>Majiq</td>
<td align="right">2492</td>
<td align="right">126</td>
<td align="right">90</td>
<td align="right">82</td>
</tr>
<tr>
<td>JunctionSeq</td>
<td align="right">273</td>
<td align="right">43</td>
<td align="right">24</td>
<td align="right">268</td>
</tr>
<tr>
<td>Leafcutter</td>
<td align="right">131474</td>
<td align="right">43</td>
<td align="right">1</td>
<td align="right">158</td>
</tr>
</tbody>
</table>
<p><strong>Table 5.2: Methods and number of SJ in each classification case </strong></p>
<p>Junctionseq achieves the highest number of TP calls and Junctionseq and Leafcutter the lowest number of FP calls. Based on that procedure, we proceeded with a two-class validation and computed the Receiver Operating Characteristic (ROC) curve and the precision-recall curve. </p>
<p><img alt="" src="img/roc_curve.png"/>
<img alt="" src="img/pr_curve.png"/> </p>
<p><strong>Fig 5.3 ROC and Precision-recall curve</strong>: we observe the in this benchmark JunctionSeq outperforms Majiq and Leafcutter. </p>
<p>The curves shows that Junctionseq outperforms the other two methods in the conditions we have analysed.</p>
<p>Despite the punctual similarities, the implementation of these three state-of-art methods vary. Here we present a direct comparison on a set of artificial transcripts. The cumulative differences in who to define which SJ are extracted and tested; how much the method relies on the annotation; and the framework for statistical modelling explain the small intersections in <strong> Fig. 5.2 </strong>.</p>
<p>In this case, Leafcutter suffers from a recall ceiling issue, because it ignores certain introns from the artificial transcripts. JunctionSeq has a clear advantage in this comparison because it relies heavily on the information of the annotation and the input annotation, that in this case, perfectly represents the structure of the transcripts.
Majiq suffers from an excess of false-positive calls. Baltica aims to further study these implementations differences and potentially suggestion advice to minimize the effect of the limitations mentioned above.</p>
<!-- This benchmark uses the SIRV complete annotation. Junctionseq would not perform as well in incomplete annotation or over-annotated cases  -->
<div class="footnote">
<hr/>
<ol>
<li id="fn:2">
<p>https://www.lexogen.com/sirvs/#sirvsdownload - Lexogen took no part in the experimental design neither we have any relationship with the company. <a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn:1">
<p>Jennifer V Gerbracht, Volker Boehm, Thiago Britto-Borges, Sebastian Kallabis, Janica L Wiederstein, Simona Ciriello, Dominik U Aschemeier, Marcus Krüger, Christian K Frese, Janine Altmüller, and et al. Casc3 promotes transcriptome-wide activation of nonsense-mediated decay by the exon junction complex. <em>Nucleic Acids Research</em>, Jul 2020. URL: <a href="http://dx.doi.org/10.1093/nar/gkaa564">http://dx.doi.org/10.1093/nar/gkaa564</a>, <a href="https://doi.org/10.1093/nar/gkaa564">doi:10.1093/nar/gkaa564</a>. <a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 2 in the text">↩</a><a class="footnote-backref" href="#fnref2:1" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a class="md-flex md-footer-nav__link md-footer-nav__link--prev" href="workflows.html" rel="prev" title="4 - Methods">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                4 - Methods
              </span>
</div>
</a>
<a class="md-flex md-footer-nav__link md-footer-nav__link--next" href="integration.html" rel="next" title="6 - DJU methods result integration">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                6 - DJU methods result integration
              </span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            Thiago Britto-Borges, Dieterichlab - MIT License
          </div>
        
        powered by
        <a href="https://www.mkdocs.org" rel="noopener" target="_blank">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs</a>
</div>
</div>
</div>
</footer>
</div>
<script src="assets/javascripts/application.c33a9706.js"></script>
<script>app.initialize({version:"1.0.4",url:{base:"."}})</script>
</body>
</html>